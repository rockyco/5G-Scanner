<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .host-box { fill: #f8f9fa; stroke: #333; stroke-width: 2; }
      .hw-box { fill: #e8e8e8; stroke: #333; stroke-width: 2; }
      .net-box { fill: #e1ffe1; stroke: #063; stroke-width: 2; }
      .rfnoc-box { fill: #fff8dc; stroke: #8b4513; stroke-width: 2; }
      .processing-box { fill: #ffd700; stroke: #ff8c00; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; }
      .small-text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .title { font-size: 18px; font-weight: bold; }
      .arrow { stroke: #333; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .wireless { stroke: #333; stroke-width: 3; stroke-dasharray: 8,4; fill: none; marker-end: url(#arrowhead); }
      .data-flow { stroke: #0066cc; stroke-width: 2; fill: none; marker-end: url(#bluearrow); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <polygon points="0 0, 10 5, 0 10" fill="#333" />
    </marker>
    <marker id="bluearrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <polygon points="0 0, 10 5, 0 10" fill="#0066cc" />
    </marker>
  </defs>
  
  <!-- 5G Cell Tower -->
  <g id="tower">
    <rect x="20" y="200" width="180" height="300" class="net-box" rx="10" />
    <text x="110" y="230" class="text title">5G Cell Tower</text>
    
    <!-- Tower Icon -->
    <line x1="110" y1="250" x2="110" y2="380" stroke="#333" stroke-width="4" />
    <line x1="80" y1="280" x2="140" y2="280" stroke="#333" stroke-width="3" />
    <line x1="90" y1="310" x2="130" y2="310" stroke="#333" stroke-width="3" />
    <line x1="100" y1="340" x2="120" y2="340" stroke="#333" stroke-width="3" />
    
    <!-- Wireless signals -->
    <path d="M 140 290 Q 160 290 180 290" stroke="#333" stroke-width="2" fill="none" opacity="0.7" />
    <path d="M 150 280 Q 180 280 210 280" stroke="#333" stroke-width="2" fill="none" opacity="0.5" />
    <path d="M 160 300 Q 190 300 220 300" stroke="#333" stroke-width="2" fill="none" opacity="0.3" />
    
    <text x="110" y="420" class="small-text">gNodeB</text>
    <text x="110" y="440" class="small-text">5G NR Bands:</text>
    <text x="110" y="460" class="small-text">n1, n3, n77, n78, n79</text>
  </g>
  
  <!-- USRP X310 -->
  <g id="usrp">
    <rect x="400" y="150" width="400" height="400" class="hw-box" rx="10" />
    <text x="600" y="180" class="text title">USRP X310</text>
    
    <!-- RFNoC Section -->
    <rect x="420" y="200" width="360" height="280" class="rfnoc-box" rx="5" />
    <text x="600" y="220" class="text">RFNoC</text>
    
    <!-- Internal Components -->
    <rect x="440" y="240" width="80" height="40" fill="#e6e6fa" stroke="#333" rx="3" />
    <text x="480" y="265" class="small-text">Radio 0</text>
    
    <rect x="540" y="240" width="80" height="40" fill="#e6e6fa" stroke="#333" rx="3" />
    <text x="580" y="265" class="small-text">DDC 0</text>
    
    <rect x="640" y="240" width="100" height="40" fill="#ffd700" stroke="#ff8c00" rx="3" />
    <text x="690" y="265" class="small-text">SSB Detector</text>
    
    <!-- Processing Pipeline -->
    <rect x="420" y="320" width="340" height="120" class="processing-box" rx="5" />
    <text x="590" y="340" class="text">detectSSB</text>
    
    <rect x="440" y="360" width="100" height="30" fill="#98fb98" stroke="#333" rx="3" />
    <text x="490" y="380" class="small-text">pssCorrelator</text>
    
    <rect x="560" y="360" width="80" height="30" fill="#98fb98" stroke="#333" rx="3" />
    <text x="600" y="380" class="small-text">peakFinder</text>
    
    <rect x="660" y="360" width="80" height="30" fill="#87ceeb" stroke="#333" rx="3" />
    <text x="700" y="380" class="small-text">extractSSBsig</text>
    
    <!-- USRP Device -->
    <rect x="440" y="500" width="100" height="30" fill="#d3d3d3" stroke="#333" />
    <text x="490" y="520" class="small-text">Ethernet/PCIe</text>
    
    <!-- Antenna -->
    <ellipse cx="350" cy="350" rx="30" ry="60" fill="#fff" stroke="#333" stroke-width="2" />
    <text x="350" y="355" class="small-text">ANT</text>
  </g>
  
  <!-- Host Computer -->
  <g id="host">
    <rect x="900" y="150" width="280" height="400" class="host-box" rx="10" />
    <text x="1040" y="180" class="text title">Host Computer</text>
    
    <!-- Monitor Display -->
    <rect x="920" y="200" width="240" height="180" fill="#000" stroke="#333" stroke-width="3" rx="5" />
    <rect x="930" y="210" width="220" height="160" fill="#1e3a8a" stroke="none" />
    
    <!-- Display Content -->
    <text x="1040" y="240" fill="#fff" class="small-text">5G Scanner Web UI</text>
    <rect x="940" y="250" width="60" height="40" fill="#4ade80" opacity="0.8" />
    <rect x="1010" y="250" width="60" height="40" fill="#60a5fa" opacity="0.8" />
    <rect x="1080" y="250" width="60" height="40" fill="#f87171" opacity="0.8" />
    
    <rect x="940" y="300" width="60" height="40" fill="#fbbf24" opacity="0.8" />
    <rect x="1010" y="300" width="60" height="40" fill="#a78bfa" opacity="0.8" />
    <rect x="1080" y="300" width="60" height="40" fill="#34d399" opacity="0.8" />
    
    <!-- Monitor Stand -->
    <rect x="1020" y="380" width="40" height="40" fill="#333" />
    <rect x="1000" y="420" width="80" height="10" fill="#333" />
    
    <!-- Software Stack -->
    <rect x="920" y="450" width="240" height="80" fill="#e1f5ff" stroke="#036" rx="5" />
    <text x="1040" y="470" class="small-text">Flask Backend</text>
    <text x="1040" y="490" class="small-text">USRP Controller</text>
    <text x="1040" y="510" class="small-text">GSCN Calculator</text>
  </g>
  
  <!-- Arrows -->
  <!-- Wireless from Tower to USRP -->
  <path d="M 200 350 L 320 350" class="wireless" />
  <text x="260" y="340" class="small-text">5G SSB Signals</text>
  
  <!-- USRP internal flow -->
  <path d="M 520 260 L 540 260" class="data-flow" />
  <path d="M 620 260 L 640 260" class="data-flow" />
  <path d="M 690 280 L 690 320" class="data-flow" />
  
  <!-- USRP to Host -->
  <path d="M 800 350 L 900 350" class="arrow" />
  <text x="850" y="340" class="small-text">Ethernet/PCIe</text>
  
  <!-- Labels -->
  <text x="50" y="50" class="title">5G NR SSB Scanner System Architecture</text>
  
  <!-- Output indicators -->
  <g transform="translate(750, 390)">
    <rect x="0" y="0" width="120" height="60" fill="#e0f2fe" stroke="#0284c7" rx="5" />
    <text x="60" y="20" class="small-text">ssbSigOut</text>
    <text x="60" y="40" class="small-text">ssbNumsDetected</text>
  </g>
</svg>